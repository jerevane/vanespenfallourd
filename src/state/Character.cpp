// Generated by dia2code
#ifndef STATE__CHARACTER__C
#define STATE__CHARACTER__C

#include "Character.h"

namespace state {

    Character::Character() {
        Element();
        XPToNextLevel = 50;
        PowerToOverdrive = 5;
        IsCharacter = true;
    }

    Character::Character(int characterID) {
        Element();
        XPToNextLevel = 50;
        PowerToOverdrive = 5;
        IsCharacter = true;
        texture = new sf::Texture;
        if(characterID==0){
            SphereGridInstance = SphereGrid(0);
            texture->loadFromFile("../res/Claude_64x64/Claude014.png");
        }
        else {
            SphereGridInstance = SphereGrid(1);
            texture->loadFromFile("../res/Youenn_64x64/Youenn014.png");
        }

    }

    void Character::LevelUp() {
        setLevel(getLevel()+1);
        SphereGridInstance.setPosition(SphereGridInstance.getPosition()+1);
        SphereGridInstance.LevelUp(SphereGridInstance.getId(), SphereGridInstance.getPosition());
    }

    void Character::GainXP(int xp) {
        int xp_to_next = getXpToNextLevel();
        int tab_xp[30];
        int i;
        // Tableau d'xp necessaire pour chaque level
        for(i=0;i<30;i++){
            tab_xp[i] = 100*i+50;
        }
        // Si il y a assez d'xp pour monter au niveau suppÃ©rieur
        if(xp > xp_to_next){
            LevelUp();
            xp = xp - xp_to_next;
            // Si il y a encore assez pour un second niveau
            if(xp > tab_xp[getLevel()-1]) {
                xp = xp - tab_xp[getLevel() - 1];
                LevelUp();
                setXpToNextLevel(tab_xp[getLevel() - 1] - xp);
            }
            else setXpToNextLevel(tab_xp[getLevel()-1]-xp);
        }
        else setXpToNextLevel(xp_to_next-xp);
    }

    SphereGrid Character::getSphereGridInstance() {
        return SphereGridInstance;
    }

    void Character::setSphereGridInstance(SphereGrid spheregridinstance) {
        SphereGridInstance = spheregridinstance;
    }

    int Character::getXpToNextLevel() {
        return XPToNextLevel;
    }

    void Character::setXpToNextLevel(int xptonextlevel) {
        XPToNextLevel = xptonextlevel;
    }

    int Character::getPowerToOverdrive() {
        return PowerToOverdrive;
    }

    void Character::setPowerToOverdrive(int powertooverdrive) {
        PowerToOverdrive = powertooverdrive;
    }

    void Character::managementOverdrive(std::string overdriveAbility) {
        int power = getPowerToOverdrive();
        if(power==0) abilities.setAbility(overdriveAbility);
        else setPowerToOverdrive(power -1);
    }



};

#endif
