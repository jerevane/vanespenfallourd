// Generated by dia2code
#ifndef INSTANCE__WORLDMAP__C
#define INSTANCE__WORLDMAP__C

#include <render/WorldmapRenderer.h>
#include <iostream>
#include "Worldmap.h"
#include "../state.hpp"

namespace instance {

    Worldmap::Worldmap(sf::RenderWindow* w, render::WorldmapRenderer* rd) : Screen(w), renderer(rd) {
    }

    Worldmap::~Worldmap() {}

    void Worldmap::init(state::State* state) {
        this->state = state;

        renderer->initRender();

    }


    void Worldmap::eventHandler() {
        if(sf::Keyboard::isKeyPressed(sf::Keyboard::Down))
        {

        }
        if(sf::Keyboard::isKeyPressed(sf::Keyboard::Up))
        {

        }
        if(sf::Keyboard::isKeyPressed(sf::Keyboard::Left))
        {
            if (!(state->getNode()->getId() <= 0)) {
                renderer->renderNodeChange(renderer->tabNodeSprite.at((state->getNode()->getId())),
                                           renderer->tabNodeSprite.at((state->getNode()->getId() - 1)));
                state->setNode(state->getNode()->getPreviousNode());
            }

        }
        if(sf::Keyboard::isKeyPressed(sf::Keyboard::Right))
        {
            if (!(state->getNode()->getId() >= 8)) {
                renderer->renderNodeChange(renderer->tabNodeSprite.at((state->getNode()->getId())),
                                           renderer->tabNodeSprite.at((state->getNode()->getId() + 1)));
                state->setNode(state->getNode()->getNextNode());
            }



        }
        if(sf::Keyboard::isKeyPressed(sf::Keyboard::Return))
        {
            //TODO: Launch event
            //Switch case depending on node id, launch a different fight/event
            std::cout << "Fight would start if it was implemented" << std::endl;
            render::FightRenderer* fightR = new render::FightRenderer(window);
            Fight* f1 = new Fight(window, fightR, state);
            f1->init();
            f1->run(fightR);
        }
    }

    void Worldmap::setState(state::State *state) {
        this->state = state;
    }

    void Worldmap::init() {
        //unused, refer to init(state)
    }
};

#endif
